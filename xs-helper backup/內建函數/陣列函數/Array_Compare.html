
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- Google tag (gtag.js) -->
<script async="async" src="https://www.googletagmanager.com/gtag/js?id=GTM-NHPFZR5F"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'GTM-NHPFZR5F');
    </script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=EmulateIE8" http-equiv="X-UA-Compatible"/>
<meta content="website" property="og:type"/>
<meta content="XS語法" property="og:site_name"/>
<meta content="https://xshelp.xq.com.tw/XSHelp/Content/Images/png-07-xs-155-90.png" property="og:image"/>
<meta content="Array_Compare(內建函數) - XS語法" property="og:title"/>
<meta content="比較陣列A跟陣列B內的元素Array_Compare(陣列A, 陣列A開始比對的位置, 陣列B, 陣列B開始比對的位置, 比對的個數)如果陣列A比較大則回傳1，如果陣列B比較大則回傳-1，如果相同的話則回傳0，例外情形回傳-2" property="og:description"/>
<link href="/XSHelp/Content/Images/favicon.ico" rel="icon" type="image/ico"/>
<link href="/XSHelp/Content/css?v=MmAetLgQWTpj53h5C1K54227FFaG9xOGVb-qgk1DRGE1" rel="stylesheet"/>
<script type="text/javascript">
        // todo: js 參數替換
        gConfig = {
            site_path: "/XSHelp/",
            site_url: "http://xshelp.xq.com.tw/",
            djsite_url: "http://jv-testweb/",
            url_suffix: "",
            runat_asp: "1",
            d: ""
        };
    </script>
<script src="/XSHelp/bundles/jquery?v=14H8EzIR27VT10jKdQjUdjivbIr5qhF08VKu4RwT7rI1"></script>
</head>
<body>
<!-- Google Tag Manager -->
<noscript>
<iframe height="0" src="//www.googletagmanager.com/ns.html?id=GTM-WMXRLD" style="display:none;visibility:hidden" width="0"></iframe>
</noscript>
<script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    '//www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WMXRLD');</script>
<!-- End Google Tag Manager -->
<div class="clearfix" id="container">
<div id="help-main">
<div class="menu_side">
<div class="xq_logo">
<a href="https://www.xq.com.tw/">
<img src="/XSHelp/Content/Images/png-xsh-180-60.png"/>
</a>
</div>
<div class="help_logo">
<img src="/XSHelp/Content/Images/png-07-xs-155-90.png"/>
</div>
<script charset="UTF-8" src="/XSHelp/Scripts/util.string.js" type="text/javascript"></script>
<script charset="UTF-8" src="/XSHelp/Scripts/jmoneyui.autolist.js" type="text/javascript"></script>
<script charset="UTF-8" src="/XSHelp/Scripts/util.onPos.js" type="text/javascript"></script>
<script charset="UTF-8" src="/XSHelp/Scripts/util.onRange.js" type="text/javascript"></script>
<link href="/XSHelp/Content/jmoneyui.autolist.css" rel="stylesheet" type="text/css"/>
<div class="search">
<input class="inputarea default" type="text" value="函數、關鍵字或欄位"/>
<button class="inputSearch"></button>
</div>
<script type="text/javascript">
    (function () {
        var cookie_key = 'search_record';
        $('.inputarea').autolist({
            source: function (req, res) {
                $.getJSON($.xshelp.genDJPath(gConfig['site_path'] + 'rest', { a: encodeURIComponent(req.term) }), null, function (data) {
                    var x = $.map(data, function (val, i) {
                        return {
                            label: cText(val),
                            value: $.xshelp.genDJPath(gConfig['site_path'] + 'index', { HelpName: encodeURIComponent(val['name']), group: val['Description'] })
                        };
                    });
                    res(x);
                });
            },
            select: function (event, ui) {
                var val = $(this).val();
                var url = $.xshelp.genDJPath(gConfig['site_path'] + 'search', { a: encodeURIComponent(val) });
                $.cookie(cookie_key, decodeURIComponent(url), { secure: true });
                window.location = ui.item.value;
            },
            directEnter: function (event, ui) {
                var keyword = $(this).val();
                if (typeof keyword == 'string' && keyword != '') {
                    var url = $.xshelp.genDJPath(gConfig['site_path'] + 'search', { a: encodeURIComponent(keyword) });
                    $.cookie(cookie_key, decodeURIComponent(url), { secure: true });
                    window.location = url;
                }
            },
            dataMax: 50
        });

        $('.inputSearch').click(function () {
            var keyword = $('.inputarea').val();
            if (typeof keyword == 'string' && keyword != '') {
                var url = $.xshelp.genDJPath(gConfig['site_path'] + 'search', { a: encodeURIComponent(keyword) });
                $.cookie(cookie_key, decodeURIComponent(url), { secure: true });
                window.location = url;
            }
        });

        function cText(obj) {
            if (/^1/.test(obj['categoryid'])) {
                return obj['name'] + '(' + obj['father'] + ')';
            }
            if (/^(2|3)/.test(obj['categoryid'])) {
                //                var str = (obj['ename'])? obj['ename'] : obj['abbrev'];
                return obj['name'] + '(' + obj['father'] + ')';
            }
            if (/^4/.test(obj['categoryid'])) {
                return obj['name'] + '(' + obj['father'] + ')';
            }
        }
    })();

</script>
<div id="cssmenu">
<ul>
<li>
<a href="javascript:void(0);"><span>檢視紀錄</span></a>
<ul></ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>關鍵字</span></a>
<ul>
<li class="even">
<a href="/XSHelp/lists?a=SKIPWORD">忽略字</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=CONSTANT">常數</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=CONTROLFLOW">流程控制</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=DECLARATION">宣告</a>
</li>
</ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>內建函數</span></a>
<ul>
<li class="even">
<a href="/XSHelp/lists?a=GENERALFUNC">一般函數</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=TIMEFUNC">時間函數</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=DATEFUNC">日期函數</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=STRINGFUNC">字串函數</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=NUMBERFUNC">數學函數</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=FIELDFUNC">欄位函數</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=ARRAYFUNC">陣列函數</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=TRANSACTIONFUNC">交易函數</a>
</li>
</ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>系統函數</span></a>
<ul>
<li class="odd">
<a href="/XSHelp/lists?a=PRICEGETFUNC">價格取得</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=PRICECULFUNC">價格計算</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=PRICERELFUNC">價格關係</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=TECHINDEXFUNC">技術指標</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=DATERELFUNC">日期相關</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=TRANSACTIONRELFUNC">交易相關</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=STATSFUNC">統計分析</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=TRENDFUNC">趨勢分析</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=LOGICFUNC">邏輯判斷</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=FUTUREFUNC">期權相關</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=FREQUENCYFUNC">跨頻率</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=ARRAYSYSFUNC">Array函數</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=VOLUMERELFUNC">量能相關</a>
</li>
</ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>報價欄位</span></a>
<ul>
<li class="odd">
<a href="/XSHelp/lists?a=QOFTEN">常用</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=QPRICE">價格</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=QVOLUME">量能</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=QFINANCE">財務</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=QMARKET">市場統計</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=QOPTION">期權</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=QFIVE">五檔統計</a>
</li>
</ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>資料欄位</span></a>
<ul>
<li class="odd">
<a href="/XSHelp/lists?a=TOFTEN">常用</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=TPRICE">價格</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=TVOLUME">量能</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=TCHIP">籌碼</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=TBASIC">基本</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=TEVENT">事件</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=TMARKET">市場統計</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=TOPTION">期權</a>
</li>
</ul>
</li>
<li class="has-sub">
<a href="javascript:void(0);"><span>選股欄位</span></a>
<ul>
<li class="odd">
<a href="/XSHelp/lists?a=FOFTEN">常用</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=FPRICE">價格</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=FVOLUME">量能</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=FCHIP">籌碼</a>
</li>
<li class="odd">
<a href="/XSHelp/lists?a=FBASIC">基本</a>
</li>
<li class="even">
<a href="/XSHelp/lists?a=FFINANCE">財務</a>
</li>
<li class="last odd">
<a href="/XSHelp/lists?a=FEVENT">事件</a>
</li>
</ul>
</li>
<li><a class="search_record" href="javascript:void(0);"><span>搜尋記錄</span></a></li>
<li class="last">
<a href="https://github.com/sysjust-xq/XScript_Preset" target="_blank">
<span title="系統腳本的程式碼集">GitHub</span>
</a>
</li>
</ul>
</div>
<script charset="UTF-8" src="/XSHelp/Scripts/menu-jquery.js" type="text/javascript"></script>
<script type="text/javascript">
    (function () {
        var obj = $.cookie('search_record');
        if (obj != null && typeof obj == 'string' && obj) {
            $('.search_record').attr('href', obj);
        }

        var list = $.cookie($.xshelp.ViewRecookieName);
        var ary = [];
        if (list != null) {
            ary = list.split(",");
        }
        ary = $.map(ary, function (n, i) {
            var item = n.split('*');
            return { link: $.xshelp.genDJPath('index', { HelpName: encodeURIComponent(item[0]), group: item[1] }), name: item[0] };
        });

        if (ary.length > 0) {
            var str = '';
            $.each(ary, function (i, o) {
                str += '<li title="' + o['name'] + '"><a href="' + o['link'] + '"><span>' + o['name'] + '</span></a></li>';
            });
            $('#cssmenu > ul > li:first').addClass('has-sub').children('ul').append(str);
        }
    })();
</script>
</div>
<div class="result">
<div class="content-txt">
<div class="content-txt">
<div class="fnc-title">
        Array_Compare -  (內建函數)
        <span class="fnc-tag">陣列函數</span>
</div>
<div class="section-title">語法：</div>
<div class="syntax">
        比較陣列A跟陣列B內的元素<br/>Array_Compare(陣列A, 陣列A開始比對的位置, 陣列B, 陣列B開始比對的位置, 比對的個數)<br/>如果陣列A比較大則回傳1，如果陣列B比較大則回傳-1，如果相同的話則回傳0，例外情形回傳-2
    </div>
<div class="section-title">說明：</div>
<div class="desc">
<p>比對執行的方式如下:</p>
<ul>
<li>先比較 <strong>陣列A[比對開始位置]</strong> 跟 <strong>陣列B[比對開始位置]</strong> 這兩個數值，如果陣列A的值比較大的話則回傳1，如果陣列B的值比較大的話則回傳-1，否則繼續比對兩個陣列的下一個數值(<strong>陣列A[比對開始位置+1]</strong> 與 <strong>陣列B[比對開始位置+1]</strong>)。</li>
<li>同樣的，如果陣列A的值比較大的話則回傳1，如果陣列B的值比較大的話則回傳-1，否則繼續比對下去直到比對個數超過為止。</li>
<li>如果比到最後都是一樣的話，則回傳0。</li>
<li>如果比對的範圍超過Array的大小的話，則回傳-2。</li>
</ul>
<p>舉例:</p>
<pre><code>Array: arrA[5](0); // 宣告arrA是一個有5個元素的陣列，初始值都是0
Array: arrB[5](0); // 宣告arrB是一個有5個元素的陣列，初始值都是0
Array: arrC[5](0); // 宣告arrC是一個有5個元素的陣列，初始值都是0


arrA[1] = 0;  arrA[2] = 10; arrA[3] = 20; arrA[4] = 30; arrA[5] = 40;
arrB[1] = 0;  arrB[2] = 0;  arrB[3] = 10; arrB[4] = 20; arrB[5] = 30;
arrC[1] = 0;  arrC[2] = 20; arrC[3] = 30; arrC[4] = 40; arrC[5] = 50;


Value1 = Array_Compare(arrA, 1, arrB, 1, 3); // 範例1: Value1 = 1
Value2 = Array_Compare(arrA, 1, arrC, 1, 3); // 範例2: Value2 = -1
Value3 = Array_Compare(arrA, 1, arrB, 2, 3); // 範例3: Value3 = 0
Value4 = Array_Compare(arrA, 1, arrB, 1, 8); // 範例4: Value4 = -2
</code></pre>
<p>第一個範例比對arrA的第一個位置開始的三個數字跟arrB的第一個位置開始的三個數字，也就是比對 (arrA[1], arrA[2], arrA[3])這三個數字與 (arrB[1], arrB[2], arrB[3])這三個數字的差異。其中 arrA的三個數字分別為 (0, 10, 20), 而 arrB的三個數字分別為 (0, 0, 10)。比對時兩邊的第一個數字是相同的(都是0)，而第二個數字 arrA的10 &gt; arrB的0，所以回傳1。</p>
<p>第二個範例比對arrA的第一個位置開始的三個數字跟arrC的第一個位置開始的三個數字，也就是比對 (arrA[1], arrA[2], arrA[3])這三個數字與 (arrC[1], arrC[2], arrC[3])這三個數字的差異。其中 arrA的三個數字分別為 (0, 10, 20), 而 arrC的三個數字分別為 (0, 20, 30)。比對時兩邊的第一個數字是相同的(都是0)，而第二個數字 arrA的10 &lt; arrC的20，所以回傳-1。</p>
<p>第三個範例比對arrA的第一個位置開始的三個數字跟arrB的第二個位置開始的三個數字，也就是比對 (arrA[1], arrA[2], arrA[3])這三個數字與 (arrB[2], arrB[3], arrB[4])這三個數字的差異。其中 arrA的三個數字分別為 (0, 10, 20), 而 arrB的三個數字分別為 (0, 10, 20)。由於這三個數字都一樣，所以回傳0。</p>
<p>第四個範例內，從第一個位置開始比，總共比8個，可是陣列內只有5個元素，超過範圍，於是回傳-2。</p>
</div>
</div>
<!-- XSHighlight -->
<link href="https://www.moneydj.com/XSHighlight/main.css" rel="stylesheet"/>
<script src="https://www.moneydj.com/XSHighlight/main-with-react.js"></script>
<style>
    pre {
        padding: 0;
        margin: 0;
        background-color: #ffffff;
        border: 0;
    }
</style>
<script language="javascript" type="text/javascript">
    if (XSHighlight) {
        const nodes = document.querySelectorAll('pre>code');
        XSHighlight.render(XSHighlight.Viewer, { enableCopy: true }, nodes);
    }
</script>
<script type="text/javascript">
    var name = $.xshelp.getUrlParam('HelpName');
    var category = $.xshelp.getUrlParam('group');
    if (name && category) {
        $.getJSON($.xshelp.genDJPath(gConfig['site_path'] + 'getf', { a: name, g: category }), null, function (data) {
            var list = $.cookie($.xshelp.ViewRecookieName);
            var str = data.name + '*' + category;
            if (typeof list == 'undefined' || list === null) {
                $.cookie($.xshelp.ViewRecookieName, str, { secure: true });
            }
            else {
                var ary = list.split(',');
                var existed = false;
                $.each(ary, function (i, o) {
                    var name = o.split('*')[0];
                    if (name == data.name) {
                        existed = true;
                        return false;
                    }
                });
                if (!existed) {
                    if (ary.length >= 10) {
                        ary.pop();
                    }
                    ary.unshift(str);
                    $.cookie($.xshelp.ViewRecookieName, ary.join(','), { secure: true });
                }
            }
        });
    }
</script>
</div>
</div>
</div>
</div>
<footer>
<center>
<div class="footer">
<div class="footer_div">
<div class="flogo">
<img src="/XSHelp/Content/Images/png-00-header-xqlite-180-60.png"/>
</div>
<div class="ftext">
                    客服電話：0800-006-098 客服信箱：<a href="mailto:XQservice@XQ.com.tw">XQservice@XQ.com.tw</a><br/>
                    最佳瀏覽模式：解析度1024*768以上；瀏覽器建議使用 IE9.0以上。<br/>
                    本站內容僅供參考，本公司不負任何法律責任，投資人若依此以為買賣依據，須自負盈虧之責。<br/>
                    版權所有嘉實資訊股份有限公司，未經合法授權請勿翻載。 與本網站有關一切糾紛與法律問題，<br/>均依中華民國相關法令解釋及適用之。<br/>
</div>
</div>
</div>
</center>
</footer>
<script type="text/javascript">
        $(function () {
            var deheight = document.documentElement.clientHeight;
            var dheight = document.body.clientHeight;
            if (deheight > dheight)
                $('#help-main').css('min-height', deheight - 237);
            else
                $('#help-main').css('min-height', dheight - 237);
        });
    </script>
</body>
</html>
